<?phpinclude("../../inc/db_connect.php");$smt=$_POST['smt'];$tapel=$_POST['tapel'];$idr=$_POST['rowid'];$cek="SELECT * FROM siswa WHERE peserta_didik_id='$idr'";$bio=$connect->query($cek)->fetch_assoc();$ids=$bio['peserta_didik_id'];$filegbr = 'https://sdi-aljannah.web.id/apins/images/siswa/'.$bio['avatar'];$file_headerss = @get_headers($filegbr);if($file_headerss[0] == 'HTTP/1.1 404 Not Found') {	//$exists = false;	$avatarm="https://sdi-aljannah.web.id/apins/images/siswa/user-default.png";}else {	//$exists = true;	$avatarm='https://sdi-aljannah.web.id/apins/images/siswa/'.$bio['avatar'];};if($smt==1){	$blnawal='07';	$blnakhir='12';	$tahun=substr($tapel,0,4);}else{	$blnawal='01';	$blnakhir='06';	$tahun=substr($tapel,5,4);};$absensi=$connect->query("SELECT SUM(IF(absensi='S',1,0)) AS sakit,SUM(IF(absensi='I',1,0)) AS ijin,SUM(IF(absensi='A',1,0)) AS alfa FROM absensi WHERE peserta_didik_id='$idr' and month(tanggal)>='$blnawal' and month(tanggal)<='$blnakhir' and year(tanggal)='$tahun'")->fetch_assoc();if($absensi['sakit']==0 or empty($absensi['sakit'])){	$sakit='-';}else{	$sakit=$absensi['sakit'];};if($absensi['ijin']==0 or empty($absensi['ijin'])){	$ijin='-';}else{	$ijin=$absensi['ijin'];};if($absensi['alfa']==0 or empty($absensi['alfa'])){	$alfa='-';}else{	$alfa=$absensi['alfa'];};
?>	<form class="form" action="modul/rapor/simpan-data-absen.php" autocomplete="off" method="POST" id="absenForm">				<div class="block block-rounded text-center">					<div class="block-content block-content-full block-content-sm">					  <div class="fw-semibold"><?=$bio['nama'];?></div>					</div>					<div class="block-content block-content-full bg-body-light">					  <img class="img-avatar img-avatar-thumb" src="<?=$avatarm;?>" alt="">					</div>					<div class="block-content block-content-full" id="tampil">						<input type="hidden" name="pdid" class="form-control"  value="<?=$bio['peserta_didik_id'];?>">						<input type="hidden" name="smt" class="form-control"  value="<?=$smt;?>">						<input type="hidden" name="tapel" class="form-control"  value="<?=$tapel;?>">						<input type="hidden" name="kelas" class="form-control"  value="<?=$kelas;?>">						<div class="row mb-4">							<div class="col-12">								<div class="row items-push">									<div class="col-md-4">										<label class="form-label" for="example-ltf-email">Sakit</label>										<input type="text" class="form-control" name="sakit" value="<?=$sakit;?>">									</div>									<div class="col-md-4">										<label class="form-label" for="example-ltf-email">Ijin</label>										<input type="text" class="form-control" name="ijin" value="<?=$ijin;?>">									</div>									<div class="col-md-4">										<label class="form-label" for="example-ltf-email">Alfa</label>										<input type="text" class="form-control" name="alfa" value="<?=$alfa;?>">									</div>								</div>							</div>						</div>						<div class="block-content block-content-full block-content-sm text-end border-top">							<button type="button" class="btn btn-alt-secondary" data-bs-dismiss="modal">Tutup</button>							<button type="submit" class="btn btn-alt-primary">Simpan</button>						</div>					</div>				</div>	</form>	<script>	$("#absenForm").unbind('submit').bind('submit', function() {		var form = $(this);		$.ajax({			url : form.attr('action'),			type : form.attr('method'),			data : form.serialize(),			dataType : 'json',			beforeSend: function()				{						$("#tampil").html('Menyimpan.....<br/><div class="spinner-grow spinner-grow text-primary" role="status"><span class="sr-only">Loading...</span></div><div class="spinner-grow spinner-grow text-secondary" role="status"><span class="sr-only">Loading...</span></div><div class="spinner-grow spinner-grow text-success" role="status"><span class="sr-only">Loading...</span></div><div class="spinner-grow spinner-grow text-danger" role="status"><span class="sr-only">Loading...</span></div><div class="spinner-grow spinner-grow text-warning" role="status"><span class="sr-only">Loading...</span></div><div class="spinner-grow spinner-grow text-info" role="status"><span class="sr-only">Loading...</span></div><div class="spinner-grow spinner-grow text-light" role="status"><span class="sr-only">Loading...</span></div><div class="spinner-grow spinner-grow text-dark" role="status"><span class="sr-only">Loading...</span></div>');				},			success:function(response) {				$(".form-group").removeClass('has-error').removeClass('has-success');				if(response.success == true) {					//swal(response.messages, {buttons: false,timer: 2000,});					// reset the form					$("#syncabsen").modal('hide');					Codebase.helpers('jq-notify', {						align: 'center',             // 'right', 'left', 'center'						from: 'bottom',                // 'top', 'bottom'						type: 'success',               // 'info', 'success', 'warning', 'danger'						icon: 'fa fa-info me-5',    // Icon class						message: response.messages					});					// reload the datatables					manageMemberTable.ajax.reload(null, false);				} else {					Codebase.helpers('jq-notify', {						align: 'center',             // 'right', 'left', 'center'						from: 'bottom',                // 'top', 'bottom'						type: 'danger',               // 'info', 'success', 'warning', 'danger'						icon: 'fa fa-info me-5',    // Icon class						message: response.messages					});					$("#syncabsen").modal('hide');				}  // /else			} // success  		}); // ajax subit 						return false;	}); // /submit form for create member	</script>
																		
